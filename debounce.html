<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Document</title>
  </head>
  <body></body>
  <script>
    function debounce(fn,delay,{leading = false, trailing = true, maxwidth}={}){
        let timer = null;
        let lastInvokeTime = 0;
        let lastCallTime;
        let lastArgs, lastThis;

        function invoke(time){
            lastInvokeTime = time;
            fn.apply(lastThis, lastArgs);
            lastArgs = lastThis = null;
        }

        function startTimer(pendingfn, wait){
            return setTimeout(pendingFn, wait);
        }

        function trailingEdge(time){
            timer = null;
             if(trailing && lastArgs){
                invoke(time);
             }
        }
        function debounced(...args){
            const now = Date.now();
            const isInvoking = shouldInvoke(now);

            lastArgs = args;
            lastThis = this;
            lastCallTime = now;

            if(isInvoking){
                if(!Timer && leading){
                    invoke(now);
                }
                if(timer){
                    clearTimeout(timer);
                    timer = null;
                }
                timer = startTimer(timerExpired,delay);
            }else if(!timer){
                timer = startTimer(timerExpired, delay);
            }
        }
        function shouldInvoke(time){
            const sinceLastCall = time - lastCallTime;
            const sinceLastInvoke = time - lastInvokeTime;

            return(
                lastCallTime === undefined||
                sinceLastCall >= delay ||
                sinceLastCall < 0 ||
                (maxWait !== undefined && sinceLastInvoke >= maxWait)
            );
        }

        function timerExpired(){
            const now = Date.now();
            if(shouldInvoke(now)) {
                trailingEdge(now);
            }else{
                timer = startTimer(timerExpired, delay - (now - lastCallTime));
            }
        }

        debounced.cancel = function(){
            if(timer) clearTimeout(timer);
            timer = lastArgs = lastThis = lastCallTime = null;
        };

        debounced.flush = function(){
            if(timer) {
                clearTimeout(timer);
                trailingEdge(Date.now());
            }
        };
        return debounced;
    }
  </script>
</html>
